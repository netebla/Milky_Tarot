"""
–ü–∞—Ä—Å–µ—Ä –¥–ª—è docx —Ñ–∞–π–ª–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ —Ä–∞—Å–∫–ª–∞–¥–∞ '–≠–Ω–µ—Ä–≥–∏—è –≥–æ–¥–∞'.

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç docx —Ñ–∞–π–ª —Å –∞—Ä—Ö–µ—Ç–∏–ø–∞–º–∏ –≥–æ–¥–∞ –≤ CSV —Ñ–æ—Ä–º–∞—Ç,
–∫–æ—Ç–æ—Ä—ã–π –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –±–æ—Ç.

–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω–æ–≥–æ docx:
- –ö–∞–∂–¥—ã–π –∞—Ä—Ö–µ—Ç–∏–ø –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–æ —Å—Ç—Ä–æ–∫–∏ –≤–∏–¥–∞ "N –ê—Ä—Ö–µ—Ç–∏–ø ‚Äî –ù–∞–∑–≤–∞–Ω–∏–µ_–∫–∞—Ä—Ç—ã"
- –ó–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Å–ª–µ–¥—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–µ—Ç–∏–ø–∞

–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω–æ–≥–æ CSV:
- card_name: –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã –¢–∞—Ä–æ (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è–º –≤ cards.csv)
- description: –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–µ—Ç–∏–ø–∞ –≥–æ–¥–∞ –¥–ª—è —ç—Ç–æ–π –∫–∞—Ä—Ç—ã

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
    python src/utils/parse_year_energy.py
"""

import csv
import re
from pathlib import Path
from docx import Document


# –ú–∞–ø–ø–∏–Ω–≥ —Å–æ–∫—Ä–∞—â—ë–Ω–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –Ω–∞ –ø–æ–ª–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ä—Ç
CARD_NAME_MAPPING = {
    "–ú–∞–≥": "–ú–∞–≥",
    "–ñ—Ä–∏—Ü–∞": "–í–µ—Ä—Ö–æ–≤–Ω–∞—è –ñ—Ä–∏—Ü–∞",
    "–ò–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü–∞": "–ò–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü–∞",
    "–ò–º–ø–µ—Ä–∞—Ç–æ—Ä": "–ò–º–ø–µ—Ä–∞—Ç–æ—Ä",
    "–ñ—Ä–µ—Ü": "–ò–µ—Ä–æ—Ñ–∞–Ω—Ç",
    "–í–ª—é–±–ª—ë–Ω–Ω—ã–µ": "–í–ª—é–±–ª–µ–Ω–Ω—ã–µ",
    "–í–ª—é–±–ª–µ–Ω–Ω—ã–µ": "–í–ª—é–±–ª–µ–Ω–Ω—ã–µ",
    "–ö–æ–ª–µ—Å–Ω–∏—Ü–∞": "–ö–æ–ª–µ—Å–Ω–∏—Ü–∞",
    "–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å": "–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å",
    "–û—Ç—à–µ–ª—å–Ω–∏–∫": "–û—Ç—à–µ–ª—å–Ω–∏–∫",
    "–ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã": "–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã",
    "–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã": "–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã",
    "–°–∏–ª–∞": "–°–∏–ª–∞",
    "–ü–æ–≤–µ—à–µ–Ω–Ω—ã–π": "–ü–æ–≤–µ—à–µ–Ω–Ω—ã–π",
    "–°–º–µ—Ä—Ç—å": "–°–º–µ—Ä—Ç—å",
    "–£–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å": "–£–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å",
    "–î—å—è–≤–æ–ª": "–î—å—è–≤–æ–ª",
    "–ë–∞—à–Ω—è": "–ë–∞—à–Ω—è",
    "–ó–≤–µ–∑–¥–∞": "–ó–≤–µ–∑–¥–∞",
    "–õ—É–Ω–∞": "–õ—É–Ω–∞",
    "–°–æ–ª–Ω—Ü–µ": "–°–æ–ª–Ω—Ü–µ",
    "–°—É–¥": "–°—É–¥",
    "–ú–∏—Ä": "–ú–∏—Ä",
    "–®—É—Ç": "–®—É—Ç",
}


def extract_card_name(text: str) -> str | None:
    """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã –∏–∑ —Å—Ç—Ä–æ–∫–∏ –≤–∏–¥–∞ '1 –ê—Ä—Ö–µ—Ç–∏–ø ‚Äî –ú–∞–≥ üßö‚Äç‚ôÄÔ∏è'."""
    # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è (–Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É)
    text_lower = text.lower()
    if "–≤–µ—Ä—Ö–æ–≤–Ω–∞—è" in text_lower and "–∂—Ä–∏—Ü–∞" in text_lower:
        return "–í–µ—Ä—Ö–æ–≤–Ω–∞—è –ñ—Ä–∏—Ü–∞"
    if "–∫–æ–ª–µ—Å–æ" in text_lower and ("—Ñ–æ—Ä—Ç—É–Ω—ã" in text_lower or "—Ñ–æ—Ä—Ç—É–Ω" in text_lower):
        return "–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã"
    if "–ø–æ–≤–µ—à–µ–Ω–Ω—ã–π" in text_lower or "–ø–æ–≤–µ—à–µ–Ω–Ω—ã" in text_lower:
        return "–ü–æ–≤–µ—à–µ–Ω–Ω—ã–π"
    
    # –£–±–∏—Ä–∞–µ–º —ç–º–æ–¥–∑–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–±–µ–ª—ã –¥–ª—è –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π
    text_clean = re.sub(r'[^\w\s‚Äî\-]', '', text)
    
    # –ò—â–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω "–ê—Ä—Ö–µ—Ç–∏–ø ‚Äî –ù–∞–∑–≤–∞–Ω–∏–µ" (–º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–º)
    match = re.search(r'–ê—Ä—Ö–µ—Ç–∏–ø\s*‚Äî\s*([–ê-–Ø–∞-—è–Å—ë\s]+)', text_clean)
    if match:
        card_name = match.group(1).strip()
        card_name_lower = card_name.lower()
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (–Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É)
        if "–∫–æ–ª–µ—Å–æ" in card_name_lower and ("—Ñ–æ—Ä—Ç—É–Ω—ã" in card_name_lower or "—Ñ–æ—Ä—Ç—É–Ω" in card_name_lower):
            return "–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã"
        if "–≤–µ—Ä—Ö–æ–≤–Ω–∞—è" in card_name_lower and "–∂—Ä–∏—Ü–∞" in card_name_lower:
            return "–í–µ—Ä—Ö–æ–≤–Ω–∞—è –ñ—Ä–∏—Ü–∞"
        if "–ø–æ–≤–µ—à–µ–Ω–Ω—ã–π" in card_name_lower or "–ø–æ–≤–µ—à–µ–Ω–Ω—ã" in card_name_lower:
            return "–ü–æ–≤–µ—à–µ–Ω–Ω—ã–π"
        # –ë–µ—Ä–µ–º –ø–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ –¥–ª—è –æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã—Ö –∫–∞—Ä—Ç
        first_word = card_name.split()[0] if card_name.split() else card_name
        return CARD_NAME_MAPPING.get(first_word, first_word)
    
    # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω: –Ω–æ–º–µ—Ä –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ
    match = re.search(r'\d+\s+–ê—Ä—Ö–µ—Ç–∏–ø\s*‚Äî\s*([–ê-–Ø–∞-—è–Å—ë\s]+)', text_clean)
    if match:
        card_name = match.group(1).strip()
        card_name_lower = card_name.lower()
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (–Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É)
        if "–∫–æ–ª–µ—Å–æ" in card_name_lower and ("—Ñ–æ—Ä—Ç—É–Ω—ã" in card_name_lower or "—Ñ–æ—Ä—Ç—É–Ω" in card_name_lower):
            return "–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã"
        if "–≤–µ—Ä—Ö–æ–≤–Ω–∞—è" in card_name_lower and "–∂—Ä–∏—Ü–∞" in card_name_lower:
            return "–í–µ—Ä—Ö–æ–≤–Ω–∞—è –ñ—Ä–∏—Ü–∞"
        if "–ø–æ–≤–µ—à–µ–Ω–Ω—ã–π" in card_name_lower or "–ø–æ–≤–µ—à–µ–Ω–Ω—ã" in card_name_lower:
            return "–ü–æ–≤–µ—à–µ–Ω–Ω—ã–π"
        first_word = card_name.split()[0] if card_name.split() else card_name
        return CARD_NAME_MAPPING.get(first_word, first_word)
    
    # –ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã –≤ —Ç–µ–∫—Å—Ç–µ
    for key in sorted(CARD_NAME_MAPPING.keys(), key=len, reverse=True):  # –°–Ω–∞—á–∞–ª–∞ –¥–ª–∏–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
        if key in text:
            return CARD_NAME_MAPPING[key]
    
    return None


def parse_year_energy_docx(docx_path: str | Path, output_csv_path: str | Path) -> None:
    """
    –ü–∞—Ä—Å–∏—Ç docx —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ —Ä–∞—Å–∫–ª–∞–¥–∞ '–≠–Ω–µ—Ä–≥–∏—è –≥–æ–¥–∞' –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ CSV.
    
    –û–∂–∏–¥–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç docx:
    - –°—Ç—Ä–æ–∫–∞ —Å –Ω–æ–º–µ—Ä–æ–º –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∞—Ä—Ö–µ—Ç–∏–ø–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "1 –ê—Ä—Ö–µ—Ç–∏–ø ‚Äî –ú–∞–≥ üßö‚Äç‚ôÄÔ∏è")
    - –°—Ç—Ä–æ–∫–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≥–æ–¥–∞, –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–∞—è—Å—è –Ω–∞ "–ù–µ–±–æ–ª—å—à–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏:"
    - –ù–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ —Å —Å–æ–≤–µ—Ç–∞–º–∏ (–∫–∞–∂–¥—ã–π —Å–æ–≤–µ—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ)
    - –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –∞—Ä—Ö–µ—Ç–∏–ø–æ–º
    """
    doc = Document(docx_path)
    
    paragraphs = [p.text for p in doc.paragraphs]
    archetypes = []
    
    i = 0
    while i < len(paragraphs):
        text = paragraphs[i].strip()
        
        # –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ –∞—Ä—Ö–µ—Ç–∏–ø–∞
        card_name = extract_card_name(text)
        
        if card_name:
            # –ù–∞—à–ª–∏ –Ω–æ–≤—ã–π –∞—Ä—Ö–µ—Ç–∏–ø
            # –°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –∏ "–ù–µ–±–æ–ª—å—à–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏:"
            if i + 1 < len(paragraphs):
                description_line = paragraphs[i + 1].strip()
                
                # –†–∞–∑–¥–µ–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –∏ "–ù–µ–±–æ–ª—å—à–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏:"
                if "–ù–µ–±–æ–ª—å—à–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏:" in description_line:
                    # –û–ø–∏—Å–∞–Ω–∏–µ - —ç—Ç–æ –≤—Å—ë –¥–æ "–ù–µ–±–æ–ª—å—à–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏:"
                    description = description_line.split("–ù–µ–±–æ–ª—å—à–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏:")[0].strip()
                    tips_header = "–ù–µ–±–æ–ª—å—à–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏:"
                else:
                    # –ï—Å–ª–∏ "–ù–µ–±–æ–ª—å—à–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏:" –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –±–µ—Ä—ë–º –≤—Å—é —Å—Ç—Ä–æ–∫—É –∫–∞–∫ –æ–ø–∏—Å–∞–Ω–∏–µ
                    description = description_line
                    tips_header = ""
                
                # –°–æ–±–∏—Ä–∞–µ–º —Å–æ–≤–µ—Ç—ã (—Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ –æ–ø–∏—Å–∞–Ω–∏—è –¥–æ –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∞—Ä—Ö–µ—Ç–∏–ø–∞)
                tips = []
                j = i + 2  # –ù–∞—á–∏–Ω–∞–µ–º —Å–æ —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ –æ–ø–∏—Å–∞–Ω–∏—è
                
                while j < len(paragraphs):
                    tip_text = paragraphs[j].strip()
                    
                    # –ï—Å–ª–∏ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ –Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ –∞—Ä—Ö–µ—Ç–∏–ø–∞ - –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ–º —Å–±–æ—Ä —Å–æ–≤–µ—Ç–æ–≤
                    if not tip_text:
                        break
                    if extract_card_name(tip_text):
                        break
                    
                    # –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –∏ –Ω–µ –Ω–æ–≤—ã–π –∞—Ä—Ö–µ—Ç–∏–ø - —ç—Ç–æ —Å–æ–≤–µ—Ç
                    if tip_text:
                        tips.append(tip_text)
                    
                    j += 1
                
                # –§–æ—Ä–º–∏—Ä—É–µ–º –∏—Ç–æ–≥–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
                full_description = description
                
                if tips_header and tips:
                    # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ "–ù–µ–±–æ–ª—å—à–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏:" –∏ —Å–ø–∏—Å–æ–∫ —Å–æ–≤–µ—Ç–æ–≤
                    full_description += "\n" + tips_header + "\n"
                    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Å–æ–≤–µ—Ç—ã —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏
                    formatted_tips = "\n".join([f"‚Ä¢\t{tip}" for tip in tips])
                    full_description += formatted_tips
                elif tips:
                    # –ï—Å–ª–∏ –Ω–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞, –Ω–æ –µ—Å—Ç—å —Å–æ–≤–µ—Ç—ã, –¥–æ–±–∞–≤–ª—è–µ–º –∏—Ö
                    formatted_tips = "\n".join([f"‚Ä¢\t{tip}" for tip in tips])
                    full_description += "\n" + formatted_tips
                
                archetypes.append({
                    'card_name': card_name,
                    'description': full_description.strip()
                })
                
                # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∞—Ä—Ö–µ—Ç–∏–ø—É (–ø—Ä–æ–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏)
                i = j
            else:
                # –ï—Å–ª–∏ –Ω–µ—Ç —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–∏, –ø—Ä–æ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∞—Ä—Ö–µ—Ç–∏–ø –±–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è
                archetypes.append({
                    'card_name': card_name,
                    'description': ''
                })
                i += 1
        else:
            # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –∞—Ä—Ö–µ—Ç–∏–ø, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–µ
            i += 1
    
    # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã (–æ—Å—Ç–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—ã–π)
    seen = set()
    unique_archetypes = []
    for arch in archetypes:
        if arch['card_name'] not in seen:
            seen.add(arch['card_name'])
            unique_archetypes.append(arch)
        else:
            # –ï—Å–ª–∏ –¥—É–±–ª–∏–∫–∞—Ç, –æ–±—ä–µ–¥–∏–Ω—è–µ–º –æ–ø–∏—Å–∞–Ω–∏—è
            for existing in unique_archetypes:
                if existing['card_name'] == arch['card_name']:
                    existing['description'] += '\n\n' + arch['description']
                    break
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ CSV
    with open(output_csv_path, 'w', encoding='utf-8', newline='') as f:
        writer = csv.DictWriter(f, fieldnames=['card_name', 'description'])
        writer.writeheader()
        writer.writerows(unique_archetypes)
    
    print(f"–ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–≤–µ—Ä—à—ë–Ω. –ù–∞–π–¥–µ–Ω–æ {len(unique_archetypes)} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞—Ä—Ö–µ—Ç–∏–ø–æ–≤.")
    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ {output_csv_path}")
    
    # –í—ã–≤–æ–¥–∏–º —Å–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∫–∞—Ä—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    print("\n–ù–∞–π–¥–µ–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã:")
    for arch in unique_archetypes:
        print(f"  - {arch['card_name']}")


if __name__ == "__main__":
    # –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º
    data_dir = Path(__file__).parent.parent / "data"
    docx_path = data_dir / "–∞—Ä—Ö–µ—Ç–∏–ø—ã –≥–æ–¥–∞ —Å —Å–æ–≤–µ—Ç–∞–º–∏.docx"
    output_path = data_dir / "year_energy_archetypes.csv"
    
    if not docx_path.exists():
        print(f"–§–∞–π–ª {docx_path} –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        exit(1)
    
    parse_year_energy_docx(docx_path, output_path)

